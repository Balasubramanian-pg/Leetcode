# Identifying Unrated Books (NULL Handling)

## Overview

> [!NOTE]  
> This problem demonstrates proper handling of NULL values in SQL when filtering for records with missing data.

## 1. Problem Description

### 1.1 Table Structure

> [!TIP]  
> The books table contains book metadata including an optional rating field that may be NULL.

```
+----------------+---------+
| Column Name    | Type    |
+----------------+---------+
| book_id        | int     |
| title          | varchar |
| author         | varchar |
| published_year | int     |
| rating         | decimal |
+----------------+---------+
```

> [!IMPORTANT]  
> The solution must correctly identify records where the rating field contains NULL values.

## 2. Solution Approach

### 2.1 NULL Handling Concept

> [!TIP]  
> In SQL, NULL represents missing/unknown data and requires special operators (IS NULL) rather than equality comparisons.

> [!WARNING]  
> Using `= NULL` will never return true - always use `IS NULL` for proper NULL checking.

### 2.2 SQL Solution

```sql
SELECT 
    book_id, 
    title, 
    author, 
    published_year
FROM books
WHERE rating IS NULL
ORDER BY book_id;
```

> [!NOTE]  
> The query excludes the rating column from output since it would always be NULL in the results.

## 3. Example Output

> [!EXAMPLE]  
> Correctly identifies books with missing ratings while maintaining the requested sort order.

```
+---------+------------------------+------------------+----------------+
| book_id | title                  | author           | published_year |
+---------+------------------------+------------------+----------------+
| 2       | To Kill a Mockingbird  | Harper Lee       | 1960           |
| 4       | The Catcher in the Rye | J.D. Salinger    | 1951           |
| 6       | Lord of the Flies      | William Golding  | 1954           |
+---------+------------------------+------------------+----------------+
```

## 4. Alternative Approaches

### 4.1 Using COALESCE

```sql
SELECT 
    book_id, 
    title, 
    author, 
    published_year
FROM books
WHERE COALESCE(rating, -1) = -1
ORDER BY book_id;
```

### 4.2 Using NOT EXISTS

```sql
SELECT 
    book_id, 
    title, 
    author, 
    published_year
FROM books b
WHERE NOT EXISTS (
    SELECT 1 FROM books 
    WHERE book_id = b.book_id AND rating IS NOT NULL
)
ORDER BY book_id;
```

## 5. Performance Considerations

> [!IMPORTANT]  
> For large tables:
> - Consider adding an index on the rating column
> - NULL checks are generally efficient in most database systems
> - Avoid functions on the rating column in WHERE clauses

## 6. Common Mistakes

> [!CAUTION]  
> Attempting to use `WHERE rating = NULL` which will never match any rows
> Including the rating column in SELECT when it's not required in output

## 7. Real-World Application

> [!TIP]  
> Similar NULL handling is used for:
> - Identifying incomplete records
> - Data quality checks
> - Reporting on missing information

## 8. Edge Cases

> [!NOTE]  
> The solution correctly handles:
> - Books with 0 ratings vs NULL ratings
> - Very old books with no ratings
> - Multiple NULL ratings in the dataset

## 9. Cross-Database Solutions

### 9.1 Standard SQL

```sql
SELECT 
    book_id, 
    title, 
    author, 
    published_year
FROM books
WHERE rating IS NULL
ORDER BY book_id;
```

### 9.2 With Additional NULL Safety

```sql
SELECT 
    book_id, 
    title, 
    author, 
    published_year
FROM books
WHERE rating IS NULL OR rating = ''
ORDER BY book_id;
```

## 10. Extended Usage

To include both NULL and zero ratings:

```sql
SELECT 
    book_id, 
    title, 
    author, 
    published_year
FROM books
WHERE rating IS NULL OR rating = 0
ORDER BY book_id;
```
