# Identifying Qualified Data Scientist Candidates

## Overview

> [!NOTE]  
> This problem requires identifying candidates who possess all three specified technical skills for a Data Scientist position.

## 1. Problem Description

### 1.1 Table Structure

> [!TIP]  
> The Candidates table contains a many-to-many relationship between candidates and their skills.

```
+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| candidate_id | int     |
| skill        | varchar |
+--------------+---------+
```

> [!IMPORTANT]  
> Candidates must have ALL required skills (Python, Tableau, PostgreSQL) to qualify.

## 2. Solution Approach

### 2.1 Set Intersection Concept

> [!TIP]  
> We use aggregation with COUNT DISTINCT to verify candidates possess all required skills.

> [!WARNING]  
> Simply checking for existence of each skill separately would incorrectly include candidates missing one or more requirements.

### 2.2 SQL Solution

```sql
SELECT candidate_id
FROM Candidates
WHERE skill IN ('Python', 'Tableau', 'PostgreSQL')
GROUP BY candidate_id
HAVING COUNT(DISTINCT skill) = 3
ORDER BY candidate_id;
```

> [!NOTE]  
> The HAVING clause ensures we only return candidates with all three specified skills.

## 3. Example Output

> [!EXAMPLE]  
> Correctly identifies candidates with the complete required skill set.

```
+--------------+
| candidate_id |
+--------------+
| 123          |
| 147          |
+--------------+
```

## 4. Alternative Approaches

### 4.1 Using Multiple EXISTS Clauses

```sql
SELECT DISTINCT c1.candidate_id
FROM Candidates c1
WHERE EXISTS (SELECT 1 FROM Candidates c2 WHERE c2.candidate_id = c1.candidate_id AND c2.skill = 'Python')
  AND EXISTS (SELECT 1 FROM Candidates c3 WHERE c3.candidate_id = c1.candidate_id AND c3.skill = 'Tableau')
  AND EXISTS (SELECT 1 FROM Candidates c4 WHERE c4.candidate_id = c1.candidate_id AND c4.skill = 'PostgreSQL')
ORDER BY c1.candidate_id;
```

### 4.2 Using INTERSECT (PostgreSQL/SQL Server)

```sql
-- PostgreSQL/SQL Server version
SELECT candidate_id FROM Candidates WHERE skill = 'Python'
INTERSECT
SELECT candidate_id FROM Candidates WHERE skill = 'Tableau'
INTERSECT
SELECT candidate_id FROM Candidates WHERE skill = 'PostgreSQL'
ORDER BY candidate_id;
```

## 5. Performance Considerations

> [!IMPORTANT]  
> For large datasets:
> - Ensure proper indexing on (candidate_id, skill)
> - The GROUP BY/HAVING approach is generally most efficient
> - Consider materialized views for frequently queried skill combinations

## 6. Common Mistakes

> [!CAUTION]  
> Using OR instead of AND in WHERE conditions would return incorrect results
> Forgetting DISTINCT in COUNT could miss candidates with duplicate skill entries

## 7. Real-World Application

> [!TIP]  
> Similar queries are used in:
> - Recruitment systems
> - Skill gap analysis
> - Talent management platforms

## 8. Edge Cases

> [!NOTE]  
> The solution correctly handles:
> - Candidates with duplicate skill entries
> - Candidates with additional irrelevant skills
> - Candidates missing just one required skill

## 9. Query Explanation

The solution works by:
1. Filtering to only the required skills
2. Grouping by candidate_id
3. Counting distinct skills per candidate
4. Keeping only candidates with all 3 skills (COUNT = 3)
5. Sorting the results

## 10. Cross-Database Solutions

### 10.1 MySQL Version

```sql
SELECT candidate_id
FROM Candidates
WHERE skill IN ('Python', 'Tableau', 'PostgreSQL')
GROUP BY candidate_id
HAVING COUNT(DISTINCT skill) = 3
ORDER BY candidate_id;
```

### 10.2 PostgreSQL Version

```sql
SELECT candidate_id
FROM Candidates
WHERE skill = ANY(ARRAY['Python', 'Tableau', 'PostgreSQL'])
GROUP BY candidate_id
HAVING COUNT(DISTINCT skill) = 3
ORDER BY candidate_id;
```
